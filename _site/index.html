<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='read' hidden></marimo-mode>
    <marimo-version data-version='0.11.22' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"default_width": "medium", "cell_output": "above", "dataframes": "rich", "theme": "system", "code_editor_font_size": 14}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000, "pythonpath": []}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "language_servers": {"pylsp": {"enabled": true, "enable_mypy": true, "enable_ruff": true, "enable_flake8": false, "enable_pydocstyle": false, "enable_pylint": false, "enable_pyflakes": false}}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "full"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>model generator</title>
    <script type="module" crossorigin src="./assets/index-C_DVbbN-.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-Dx2fXC3c.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.11.22%22%0Aapp%20%3D%20marimo.App(width%3D%22full%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20tabulate%0A%20%20%20%20return%20np%2C%20pd%2C%20tabulate%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20seaborn%20as%20sns%0A%20%20%20%20return%20plt%2C%20sns%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.model_selection%20import%20train_test_split%2C%20RandomizedSearchCV%0A%20%20%20%20from%20sklearn.model_selection%20import%20StratifiedKFold%0A%20%20%20%20from%20sklearn.feature_selection%20import%20RFECV%0A%20%20%20%20return%20RFECV%2C%20RandomizedSearchCV%2C%20StratifiedKFold%2C%20train_test_split%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.svm%20import%20SVC%0A%20%20%20%20from%20sklearn.ensemble%20import%20RandomForestClassifier%0A%20%20%20%20from%20xgboost%20import%20XGBClassifier%0A%20%20%20%20return%20RandomForestClassifier%2C%20SVC%2C%20XGBClassifier%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20make_scorer%2C%20balanced_accuracy_score%0A%20%20%20%20from%20sklearn.utils.class_weight%20import%20compute_class_weight%0A%20%20%20%20return%20balanced_accuracy_score%2C%20compute_class_weight%2C%20make_scorer%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.preprocessing%20import%20LabelEncoder%2C%20OneHotEncoder%0A%20%20%20%20return%20LabelEncoder%2C%20OneHotEncoder%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20sklearn.metrics%20import%20(classification_report%2C%20roc_curve%2C%20roc_auc_score%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20confusion_matrix%2C%20accuracy_score%2C%20f1_score%2C%20precision_score%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20recall_score)%0A%20%20%20%20from%20sklearn.preprocessing%20import%20label_binarize%0A%20%20%20%20from%20sklearn.metrics%20import%20auc%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20accuracy_score%2C%0A%20%20%20%20%20%20%20%20auc%2C%0A%20%20%20%20%20%20%20%20classification_report%2C%0A%20%20%20%20%20%20%20%20confusion_matrix%2C%0A%20%20%20%20%20%20%20%20f1_score%2C%0A%20%20%20%20%20%20%20%20label_binarize%2C%0A%20%20%20%20%20%20%20%20precision_score%2C%0A%20%20%20%20%20%20%20%20recall_score%2C%0A%20%20%20%20%20%20%20%20roc_auc_score%2C%0A%20%20%20%20%20%20%20%20roc_curve%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20io%0A%20%20%20%20return%20(io%2C)%0A%0A%0A%40app.cell%0Adef%20_(io)%3A%0A%20%20%20%20def%20to_file(mo_ui_file)%3A%0A%20%20%20%20%20%20return%20io.BytesIO(mo_ui_file.contents())%0A%20%20%20%20return%20(to_file%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20dataset_upload%20%3D%20mo.ui.file(%0A%20%20%20%20%20%20%20%20kind%3D'area'%2C%0A%20%20%20%20%20%20%20%20label%3D%22%23%20Load%20Dataset%20(csv)%22%2C%0A%20%20%20%20%20%20%20%20filetypes%3D%5B'.csv'%5D%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(dataset_upload%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20Run%20Buttons%0A%20%20%20%20load_data_button%20%3D%20mo.ui.run_button(label%3D%22Load%20Data%22)%0A%20%20%20%20remove_data_button%20%3D%20mo.ui.run_button(label%3D%22Remove%20Selected%20Data%22)%0A%20%20%20%20encode_data_button%20%3D%20mo.ui.run_button(label%3D%22Run%20Encoder%22)%0A%20%20%20%20model_run_button%20%3D%20mo.ui.run_button(label%3D%22Run%20Model%22)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20encode_data_button%2C%0A%20%20%20%20%20%20%20%20load_data_button%2C%0A%20%20%20%20%20%20%20%20model_run_button%2C%0A%20%20%20%20%20%20%20%20remove_data_button%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Perovskite%20Classification%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(dataset_upload%2C%20load_data_button%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20dataset_upload%2C%0A%20%20%20%20%20%20%20%20mo.md(f%22**%7Bdataset_upload.name()%7D**%22)%2C%0A%20%20%20%20%20%20%20%20load_data_button%2C%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(dataset_upload%2C%20load_data_button%2C%20mo)%3A%0A%20%20%20%20%23%20if%20the%20button%20has%20been%20clicked%2C%20don't%20run.%0A%20%20%20%20mo.stop((load_data_button.value)%20and%20(dataset_upload.name()%20!%3D%20None))%0A%20%20%20%20mo.md('No%20Data%20is%20loaded.%20Please%20load%20data.')%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(dataset_upload%2C%20load_data_button%2C%20mo%2C%20pd%2C%20to_file)%3A%0A%20%20%20%20%23%20if%20the%20button%20hasn't%20been%20clicked%2C%20don't%20run.%0A%20%20%20%20mo.stop((not%20load_data_button.value)%20or%20(dataset_upload.name()%20%3D%3D%20None))%0A%20%20%20%20data%20%3D%20pd.read_csv(to_file(dataset_upload))%0A%20%20%20%20data%0A%20%20%20%20return%20(data%2C)%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20mo)%3A%0A%20%20%20%20_default%20%3D%20%5B%22S.No%22%2C%20%22Compound%22%2C%20%22A%22%2C%20%22B%22%2C%20%22In%20literature%22%2C%20%22v(B)%22%5D%0A%20%20%20%20feature_drop%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20data%3Ddata.columns.to_list()%2C%0A%20%20%20%20%20%20%20%20label%3D%22%23%23%20Select%20features%20to%20exclude%22%2C%0A%20%20%20%20%20%20%20%20initial_selection%3D%20%5Bi%20for%20i%2C%20x%20in%20enumerate(data.columns.to_list())%20if%20x%20in%20_default%5D%2C%0A%20%20%20%20)%0A%20%20%20%20feature_drop%0A%20%20%20%20return%20(feature_drop%2C)%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20feature_drop)%3A%0A%20%20%20%20feature_drop_list%20%3D%20feature_drop.value%0A%20%20%20%20final_feature_list%20%3D%20data.columns.difference(feature_drop_list)%0A%20%20%20%20return%20feature_drop_list%2C%20final_feature_list%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20feature_drop%2C%20mo)%3A%0A%20%20%20%20remove_data_button_col%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20data%3Dlist(set(data.columns.to_list())%20-%20set(feature_drop.value))%2C%0A%20%20%20%20%20%20%20%20label%3D%22%23%23%20Select%20features%20to%20remove%20data%22%2C%0A%20%20%20%20%20%20%20%20%23%20initial_selection%3D%20%5Bi%20for%20i%2C%20x%20in%20enumerate(_cols)%20if%20x%20in%20_default%5D%2C%0A%20%20%20%20)%0A%20%20%20%20remove_data_button_col%0A%20%20%20%20return%20(remove_data_button_col%2C)%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20feature_drop%2C%20mo%2C%20pd%2C%20remove_data_button_col)%3A%0A%20%20%20%20def%20gen_data_remove_table(data%3A%20pd.DataFrame%2C%20feature_drop%3A%20list%2C%20remove_data_col%3A%20list)%3A%0A%0A%20%20%20%20%20%20%20%20dr%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20for%20_col%20in%20remove_data_col%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data_remove%20%3D%20mo.ui.table(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%3Ddata%5B_col%5D.value_counts().to_dict()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df%22%23%23%23%20Select%20data%20to%20remove%20from%20%5B%20**%7B_col%7D**%20%5D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20dr%5B_col%5D%20%3D%20data_remove%0A%20%20%20%20%20%20%20%20%20%20%20%20dr_ui%20%3D%20%5B%20value%20for%20_%2C%20value%20in%20dr.items()%20%5D%0A%20%20%20%20%20%20%20%20return%20dr%2C%20mo.vstack(%20dr_ui%20)%0A%0A%20%20%20%20_data%20%3D%20data.drop(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20feature_drop.value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20errors%3D%22ignore%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20dr_table%2C%20dr_table_ui%20%3D%20gen_data_remove_table(_data%2C%20feature_drop%2C%20remove_data_button_col.value)%0A%20%20%20%20dr_table_ui%0A%20%20%20%20return%20dr_table%2C%20dr_table_ui%2C%20gen_data_remove_table%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(remove_data_button)%3A%0A%20%20%20%20remove_data_button%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20get_remove_data(pd)%3A%0A%20%20%20%20def%20get_remove_data_index(data%3A%20pd.DataFrame%2C%20dr_table%2C%20feature_drop_list)%3A%0A%20%20%20%20%20%20%20%20dr_dict%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20index%20%3D%20data.index%0A%20%20%20%20%20%20%20%20for%20key%2C%20value%20in%20dr_table.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_list%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20element%20in%20value.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_list.append(element%5B'key'%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20dr_dict%5Bkey%5D%20%3D%20_list%0A%20%20%20%20%20%20%20%20%20%20%20%20index%20%3D%20index.difference(data%5Bkey%5D.isin(_list).values.nonzero()%5B0%5D)%0A%20%20%20%20%20%20%20%20return%20index%0A%20%20%20%20return%20(get_remove_data_index%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20data%2C%0A%20%20%20%20dr_table%2C%0A%20%20%20%20feature_drop_list%2C%0A%20%20%20%20get_remove_data_index%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20remove_data_button%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20remove_data_button.value)%0A%20%20%20%20final_index%20%3D%20get_remove_data_index(data%2C%20dr_table%2C%20feature_drop_list)%0A%20%20%20%20return%20(final_index%2C)%0A%0A%0A%40app.cell%0Adef%20_(data%2C%20final_feature_list%2C%20final_index)%3A%0A%20%20%20%20reduced_data%20%3D%20data%5Bfinal_feature_list%5D.iloc%5Bfinal_index%5D%0A%20%20%20%20reduced_data%0A%20%20%20%20return%20(reduced_data%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Categorical%20to%20Numerical%20Encoding%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20reduced_data)%3A%0A%20%20%20%20%23%20Convert%20categorical%20columns%20to%20numerical%0A%20%20%20%20catagorical_cols%20%3D%20reduced_data.select_dtypes(include%3D%5B%22object%22%5D).columns%0A%20%20%20%20catagorical_cols%0A%20%20%20%20cat_encoders%20%3D%20%7B%7D%0A%20%20%20%20cat_encoders_ui%20%3D%20%5B%5D%0A%0A%20%20%20%20for%20_col%20in%20catagorical_cols%3A%0A%20%20%20%20%20%20%20%20_encoder%20%3D%20mo.ui.dropdown(options%3D%5B%22LabelEncoder%22%2C%20%22OneHotEncoder%22%2C%20%22Numerical%22%5D%2C%20label%3D%22Choose%20Encoder%22%2C%20value%3D%22Numerical%22)%0A%20%20%20%20%20%20%20%20cat_encoders_ui.append(%0A%20%20%20%20%20%20%20%20%20%20mo.hstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(f%22%23%23%23%20%7B_col%7D%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20_encoder%2C%0A%20%20%20%20%20%20%20%20%20%20%5D)%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20cat_encoders%5B_col%5D%20%3D%20_encoder%0A%0A%20%20%20%20mo.vstack(cat_encoders_ui)%0A%20%20%20%20return%20cat_encoders%2C%20cat_encoders_ui%2C%20catagorical_cols%0A%0A%0A%40app.cell%0Adef%20_(encode_data_button)%3A%0A%20%20%20%20encode_data_button%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(LabelEncoder%2C%20OneHotEncoder%2C%20pd)%3A%0A%20%20%20%20def%20get_encoder(encoder_name)%3A%0A%20%20%20%20%20%20%20%20if%20encoder_name%20%3D%3D%20%22LabelEncoder%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20encoder%20%3D%20LabelEncoder()%0A%20%20%20%20%20%20%20%20elif%20encoder_name%20%3D%3D%20%22OneHotEncoder%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20encoder%20%3D%20OneHotEncoder()%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20encoder%20%3D%20%22to_numeric%22%0A%20%20%20%20%20%20%20%20return%20encoder%0A%0A%20%20%20%20def%20to_numeric(data%2C%20col)%3A%0A%20%20%20%20%20%20%20%20return%20data%5Bcol%5D.apply(pd.to_numeric%2C%20errors%3D%22coerce%22)%0A%0A%20%20%20%20def%20get_encoder_from_ui(cat_encoders%2C%20catagorical_cols)%3A%0A%20%20%20%20%20%20%20%20col_encoders%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20for%20_col%20in%20catagorical_cols%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20col_encoders%5B_col%5D%20%3D%20get_encoder(cat_encoders%5B_col%5D.value)%0A%20%20%20%20%20%20%20%20return%20col_encoders%0A%20%20%20%20return%20get_encoder%2C%20get_encoder_from_ui%2C%20to_numeric%0A%0A%0A%40app.cell%0Adef%20_(LabelEncoder%2C%20OneHotEncoder%2C%20pd%2C%20to_numeric)%3A%0A%20%20%20%20def%20catagorical_to_numerical(data%2C%20col_encoders%2C%20catagorical_cols)%3A%0A%0A%20%20%20%20%20%20%20%20for%20_col%2C%20_%20in%20col_encoders.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20col_encoders%5B_col%5D%20%3D%3D%20%22to_numeric%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%5B_col%5D%20%3D%20to_numeric(data%2C%20_col)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20type(col_encoders%5B_col%5D)%20%3D%3D%20type(OneHotEncoder())%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_encoded_df%20%3D%20col_encoders%5B_col%5D.fit_transform(data%5B%5B_col%5D%5D).toarray()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_one_hot_cols%20%3D%20col_encoders%5B_col%5D.get_feature_names_out()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_encoded_df%20%3D%20pd.DataFrame(_encoded_df%2C%20columns%3D_one_hot_cols%20%2C%20dtype%3Dbool)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%5B_encoded_df.columns%5D%20%3D%20_encoded_df.to_numpy()%0A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20type(col_encoders%5B_col%5D)%20%3D%3D%20type(LabelEncoder())%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%5B_col%5D%20%3D%20col_encoders%5B_col%5D.fit_transform(data%5B%5B_col%2C%5D%5D.values.ravel())%0A%0A%20%20%20%20%20%20%20%20return%20data%0A%20%20%20%20return%20(catagorical_to_numerical%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20cat_encoders%2C%0A%20%20%20%20catagorical_cols%2C%0A%20%20%20%20catagorical_to_numerical%2C%0A%20%20%20%20encode_data_button%2C%0A%20%20%20%20get_encoder_from_ui%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20reduced_data%2C%0A)%3A%0A%20%20%20%20mo.stop(%20not%20encode_data_button.value%20)%0A%0A%20%20%20%20col_encoders%20%3D%20get_encoder_from_ui(cat_encoders%2C%20catagorical_cols)%0A%20%20%20%20prep_data%20%3D%20catagorical_to_numerical(reduced_data%2C%20col_encoders%2C%20catagorical_cols)%0A%20%20%20%20prep_data%0A%20%20%20%20return%20col_encoders%2C%20prep_data%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20prep_data)%3A%0A%20%20%20%20target_ui%20%3D%20mo.ui.dropdown(options%3Dprep_data.columns.to_list()%20%2C%20label%3D%22Choose%20Target%22)%0A%20%20%20%20target_ui%0A%20%20%20%20return%20(target_ui%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20prep_data%2C%20target_ui)%3A%0A%20%20%20%20mo.stop(%20target_ui.value%20%3D%3D%20None%20)%0A%0A%20%20%20%20X%20%3D%20prep_data.drop(target_ui.value%2C%20axis%3D1)%0A%20%20%20%20y%20%3D%20prep_data%5Btarget_ui.value%5D%0A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%20X-y%20Split%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%20%5B%20X%20Data%20%5D%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20X%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%20%5B%20y%20Data%20%5D%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20y%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20mo.md('%23%23%20%5B%20Missing%20values%20%5D')%2C%0A%20%20%20%20%20%20%20%20prep_data.isnull().sum()%0A%0A%0A%20%20%20%20%5D)%0A%20%20%20%20return%20X%2C%20y%0A%0A%0A%40app.cell%0Adef%20_(classification_report%2C%20mo%2C%20pd)%3A%0A%20%20%20%20def%20classification_report_to_dataframe(y_true%2C%20y_pred%2C%20class_names%3DNone%2C%20digits%3D2%2C%20title%3D%22Classification%20Report%22%2C%20title_level%3D1)%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Convert%20scikit-learn%20classification%20report%20to%20pandas%20DataFrame%0A%0A%20%20%20%20%20%20%20%20Parameters%3A%0A%20%20%20%20%20%20%20%20y_true%20(array)%3A%20True%20labels%0A%20%20%20%20%20%20%20%20y_pred%20(array)%3A%20Predicted%20labels%0A%20%20%20%20%20%20%20%20class_names%20(list)%3A%20List%20of%20class%20names%20in%20order%0A%20%20%20%20%20%20%20%20digits%20(int)%3A%20Number%20of%20decimal%20places%20for%20metrics%0A%0A%20%20%20%20%20%20%20%20Returns%3A%0A%20%20%20%20%20%20%20%20tuple%3A%20(metrics_df%2C%20summary_df)%20-%20Metrics%20by%20class%20and%20summary%20statistics%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Generate%20raw%20classification%20report%20dictionary%0A%20%20%20%20%20%20%20%20report_dict%20%3D%20classification_report(%0A%20%20%20%20%20%20%20%20%20%20%20%20y_true%2C%20y_pred%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20target_names%3Dclass_names%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20output_dict%3DTrue%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20digits%3Ddigits%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Extract%20class-wise%20metrics%20and%20support%0A%20%20%20%20%20%20%20%20metrics_df%20%3D%20pd.DataFrame(report_dict).transpose().reset_index()%0A%20%20%20%20%20%20%20%20metrics_df%20%3D%20metrics_df.rename(columns%3D%7B'index'%3A%20'class'%7D)%0A%0A%20%20%20%20%20%20%20%20%23%20Separate%20class%20metrics%20from%20summary%20statistics%0A%20%20%20%20%20%20%20%20summary_mask%20%3D%20metrics_df%5B'class'%5D.isin(%5B'accuracy'%2C%20'macro%20avg'%2C%20'weighted%20avg'%5D)%0A%20%20%20%20%20%20%20%20summary_df%20%3D%20metrics_df%5Bsummary_mask%5D.copy()%0A%20%20%20%20%20%20%20%20metrics_df%20%3D%20metrics_df%5B~summary_mask%5D.copy()%0A%0A%20%20%20%20%20%20%20%20%23%20Clean%20up%20formatting%0A%20%20%20%20%20%20%20%20for%20col%20in%20%5B'precision'%2C%20'recall'%2C%20'f1-score'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20metrics_df%5Bcol%5D%20%3D%20metrics_df%5Bcol%5D.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20x%3A%20f%22%7Bx%3A.%7Bdigits%7Df%7D%22%20if%20not%20pd.isna(x)%20else%20%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20summary_df%5Bcol%5D%20%3D%20summary_df%5Bcol%5D.apply(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lambda%20x%3A%20f%22%7Bx%3A.%7Bdigits%7Df%7D%22%20if%20not%20pd.isna(x)%20else%20%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20total%20support%20count%0A%20%20%20%20%20%20%20%20total_support%20%3D%20metrics_df%5B'support'%5D.sum()%0A%20%20%20%20%20%20%20%20summary_df.loc%5Bsummary_df%5B'class'%5D%20%3D%3D%20'accuracy'%2C%20'support'%5D%20%3D%20total_support%0A%0A%20%20%20%20%20%20%20%20report%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(f%22%7B'%23'*title_level%7D%20%7Btitle%7D%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%20Class-wise%20Metrics%3A%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(metrics_df.to_markdown(index%3DFalse))%2C%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%20Summary%20Statistics%3A%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(summary_df.to_markdown(index%3DFalse))%0A%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20return%20report%0A%20%20%20%20return%20(classification_report_to_dataframe%2C)%0A%0A%0A%40app.cell%0Adef%20_(X%2C%20train_test_split%2C%20y)%3A%0A%20%20%20%20X_train%2C%20X_test%2C%20y_train%2C%20y_test%20%3D%20train_test_split(X%2C%20y%2C%20test_size%3D0.33%2C%20stratify%3Dy%2C%20random_state%3D42)%0A%20%20%20%20return%20X_test%2C%20X_train%2C%20y_test%2C%20y_train%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Feature%20Selection%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20feature_selection_button%20%3D%20mo.ui.run_button(label%3D%22Run%20Feature%20Selection%22)%0A%20%20%20%20feature_selection_button%0A%20%20%20%20return%20(feature_selection_button%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20RFECV%2C%0A%20%20%20%20RandomForestClassifier%2C%0A%20%20%20%20StratifiedKFold%2C%0A%20%20%20%20X_train%2C%0A%20%20%20%20balanced_accuracy_score%2C%0A%20%20%20%20compute_class_weight%2C%0A%20%20%20%20feature_selection_button%2C%0A%20%20%20%20make_scorer%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20np%2C%0A%20%20%20%20y_train%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20feature_selection_button.value)%0A%0A%0A%0A%20%20%20%20%23%20Compute%20class%20weights%20for%20cost%20sensitivity%0A%20%20%20%20classes%20%3D%20np.unique(y_train)%0A%20%20%20%20class_weights%20%3D%20compute_class_weight(%0A%20%20%20%20%20%20%20%20class_weight%3D%22balanced%22%2C%0A%20%20%20%20%20%20%20%20classes%3Dclasses%2C%0A%20%20%20%20%20%20%20%20y%3Dy_train%0A%20%20%20%20)%0A%20%20%20%20class_weight_dict%20%3D%20%7Bcls%3A%20weight%20for%20cls%2C%20weight%20in%20zip(classes%2C%20class_weights)%7D%0A%0A%20%20%20%20%23%20Initialize%20cost-sensitive%20classifier%0A%20%20%20%20clf%20%3D%20RandomForestClassifier(%0A%20%20%20%20%20%20%20%20class_weight%3Dclass_weight_dict%2C%20%20%23%20Cost-sensitive%20adjustment%0A%20%20%20%20%20%20%20%20n_estimators%3D100%2C%0A%20%20%20%20%20%20%20%20random_state%3D42%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Custom%20scoring%20metric%20for%20imbalanced%20multi-class%0A%20%20%20%20scorer%20%3D%20make_scorer(balanced_accuracy_score)%0A%0A%20%20%20%20%23%20RFECV%20with%20cost-sensitive%20learning%0A%20%20%20%20rfecv%20%3D%20RFECV(%0A%20%20%20%20%20%20%20%20estimator%3Dclf%2C%0A%20%20%20%20%20%20%20%20step%3D1%2C%20%20%23%20Remove%201%20feature%20per%20iteration%0A%20%20%20%20%20%20%20%20cv%3DStratifiedKFold(5)%2C%20%20%23%20Stratified%20for%20imbalanced%20data%0A%20%20%20%20%20%20%20%20scoring%3Dscorer%2C%0A%20%20%20%20%20%20%20%20min_features_to_select%3D5%2C%0A%20%20%20%20%20%20%20%20n_jobs%3D-1%0A%20%20%20%20)%0A%0A%20%20%20%20for%20_%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20range(1)%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20%23%20Fit%20RFECV%0A%20%20%20%20%20%20%20%20rfecv.fit(X_train%2C%20y_train)%0A%20%20%20%20return%20class_weight_dict%2C%20class_weights%2C%20classes%2C%20clf%2C%20rfecv%2C%20scorer%0A%0A%0A%40app.cell%0Adef%20_(X_train%2C%20rfecv)%3A%0A%20%20%20%20%23%20Results%0A%20%20%20%20print(f%22Optimal%20number%20of%20features%3A%20%7Brfecv.n_features_%7D%22)%0A%20%20%20%20print(f%22Selected%20features%3A%20%7BX_train.columns%5Brfecv.support_%5D.values%7D%22)%0A%20%20%20%20X_features%20%3D%20X_train.columns%5Brfecv.support_%5D.values.tolist()%0A%20%20%20%20X_features%0A%20%20%20%20return%20(X_features%2C)%0A%0A%0A%40app.cell%0Adef%20_(plt%2C%20rfecv)%3A%0A%20%20%20%20%23%20Plot%20cross-validation%20performance%0A%20%20%20%20plt.figure(figsize%3D(8%2C%206))%0A%20%20%20%20plt.xlabel(%22Number%20of%20features%20selected%22)%0A%20%20%20%20plt.ylabel(%22Balanced%20accuracy%20(cross-validation)%22)%0A%20%20%20%20plt.plot(range(1%2C%20len(rfecv.cv_results_%5B%22mean_test_score%22%5D)%20%2B%201)%2C%20rfecv.cv_results_%5B%22mean_test_score%22%5D)%0A%20%20%20%20plt.gca()%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Model%20Training%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20_model_names%20%3D%20%5B'Random%20Forest%20Classifier'%2C%20'SVM%20Classifier'%2C%20'XGBoost%20Classifier'%5D%0A%20%20%20%20model_select_ui%20%3D%20mo.ui.dropdown(options%3D_model_names%2C%20value%3D_model_names%5B0%5D%20%2C%20label%3D%22Select%20Model%22)%0A%0A%20%20%20%20model_select_ui%0A%20%20%20%20return%20(model_select_ui%2C)%0A%0A%0A%40app.cell%0Adef%20_(model_run_button)%3A%0A%20%20%20%20model_run_button%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(RandomForestClassifier%2C%20SVC%2C%20XGBClassifier%2C%20class_weight_dict)%3A%0A%20%20%20%20def%20get_model(model_name)%3A%0A%20%20%20%20%20%20%20%20if%20model_name%20%3D%3D%20'Random%20Forest%20Classifier'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_model%20%3D%20RandomForestClassifier(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20class_weight%3Dclass_weight_dict%2C%20%20%23%20Cost-sensitive%20adjustment%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_estimators%3D100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20random_state%3D42%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20elif%20model_name%20%3D%3D%20'XGBoost%20Classifier'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_model%20%3D%20XGBClassifier(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20n_estimators%3D100%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20random_state%3D42%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20elif%20model_name%20%3D%3D%20'SVM%20Classifier'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20_model%20%3D%20SVC(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20class_weight%3Dclass_weight_dict%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20random_state%3D42%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20_model%0A%20%20%20%20return%20(get_model%2C)%0A%0A%0A%40app.cell%0Adef%20_(get_model%2C%20mo%2C%20model_run_button%2C%20model_select_ui)%3A%0A%20%20%20%20mo.stop(not%20model_run_button.value%20)%0A%20%20%20%20%23%20model%20%3D%20RandomForestClassifier(%0A%20%20%20%20%23%20%20%20%20%20class_weight%3Dclass_weight_dict%2C%20%20%23%20Cost-sensitive%20adjustment%0A%20%20%20%20%23%20%20%20%20%20n_estimators%3D100%2C%0A%20%20%20%20%23%20%20%20%20%20random_state%3D42%0A%20%20%20%20%23%20)%0A%20%20%20%20model%20%3D%20get_model(model_select_ui.value)%0A%20%20%20%20model%0A%20%20%20%20return%20(model%2C)%0A%0A%0A%40app.cell%0Adef%20_(X_features%2C%20X_test%2C%20X_train%2C%20mo%2C%20model%2C%20y_train)%3A%0A%20%20%20%20for%20_%20in%20mo.status.progress_bar(%0A%20%20%20%20%20%20%20%20range(1)%2C%0A%20%20%20%20%20%20%20%20title%3D%22Loading%22%2C%0A%20%20%20%20%20%20%20%20subtitle%3D%22Please%20wait%22%2C%0A%20%20%20%20%20%20%20%20show_eta%3DTrue%2C%0A%20%20%20%20%20%20%20%20show_rate%3DTrue%0A%20%20%20%20)%3A%0A%20%20%20%20%20%20%20%20model.fit(X_train%5BX_features%5D%2C%20y_train)%0A%20%20%20%20y_pred%20%3D%20model.predict(X_test%5BX_features%5D)%0A%20%20%20%20return%20(y_pred%2C)%0A%0A%0A%40app.cell%0Adef%20_(confusion_matrix%2C%20plt%2C%20sns)%3A%0A%20%20%20%20def%20generate_confusion_matrix(y_true%2C%20y_pred%2C%20plot%3DTrue%2C%20title%3D%22Confusion%20Matrix%22%2C%20predicted_lable%3D%22Predicted%20Label%22%2C%20true_lable%3D%22Actual%20Label%22)%3A%0A%20%20%20%20%20%20%20%20%23%20Create%20a%20confusion%20matrix%0A%20%20%20%20%20%20%20%20cm%20%3D%20confusion_matrix(y_true%2C%20y_pred)%0A%0A%20%20%20%20%20%20%20%20if%20plot%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Plot%20the%20confusion%20matrix%0A%20%20%20%20%20%20%20%20%20%20%20%20plt.figure(figsize%3D(8%2C%206))%0A%20%20%20%20%20%20%20%20%20%20%20%20sns.heatmap(cm%2C%20annot%3DTrue%2C%20cmap%3D%22GnBu%22%2C%20fmt%3D%22d%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20plt.xlabel(predicted_lable)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20plt.xticks(col_encoders%5Btarget_ui.value%5D.classes_)%0A%20%20%20%20%20%20%20%20%20%20%20%20plt.ylabel(true_lable)%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20plt.yticks(col_encoders%5Btarget_ui.value%5D.classes_)%0A%20%20%20%20%20%20%20%20%20%20%20%20plt.title(title)%0A%0A%20%20%20%20%20%20%20%20return%20cm%2C%20plt.gca()%0A%20%20%20%20return%20(generate_confusion_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_(generate_confusion_matrix%2C%20y_pred%2C%20y_test)%3A%0A%20%20%20%20_%2C%20_plot%20%3D%20generate_confusion_matrix(y_test%2C%20y_pred)%0A%20%20%20%20_plot%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20gen_report_button%20%3D%20mo.ui.run_button(label%3D%22Generate%20Report%22)%0A%20%20%20%20gen_report_button%0A%20%20%20%20return%20(gen_report_button%2C)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20classification_report_to_dataframe%2C%0A%20%20%20%20col_encoders%2C%0A%20%20%20%20gen_report_button%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20target_ui%2C%0A%20%20%20%20y_pred%2C%0A%20%20%20%20y_test%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20gen_report_button.value)%0A%20%20%20%20_labels%20%3D%20col_encoders%5Btarget_ui.value%5D.classes_%0A%20%20%20%20%23%20Generate%20report%20DataFrames%0A%20%20%20%20classification_report_to_dataframe(%0A%20%20%20%20%20%20%20%20y_test%2C%20y_pred%2C%0A%20%20%20%20%20%20%20%20class_names%3D_labels%2C%0A%20%20%20%20%20%20%20%20digits%3D3%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20X_features%2C%0A%20%20%20%20X_test%2C%0A%20%20%20%20auc%2C%0A%20%20%20%20col_encoders%2C%0A%20%20%20%20gen_report_button%2C%0A%20%20%20%20label_binarize%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20model%2C%0A%20%20%20%20np%2C%0A%20%20%20%20plt%2C%0A%20%20%20%20roc_curve%2C%0A%20%20%20%20target_ui%2C%0A%20%20%20%20y_test%2C%0A)%3A%0A%20%20%20%20mo.stop(not%20gen_report_button.value)%0A%0A%20%20%20%20_class%20%3D%20col_encoders%5Btarget_ui.value%5D.classes_%0A%0A%20%20%20%20%23%20Step%201%3A%20Get%20predicted%20probabilities%0A%20%20%20%20y_probs%20%3D%20model.predict_proba(X_test%5BX_features%5D)%0A%0A%20%20%20%20%23%20Step%202%3A%20Binarize%20y_test%0A%20%20%20%20n_classes%20%3D%20len(_class)%0A%20%20%20%20y_test_bin%20%3D%20label_binarize(y_test%2C%20classes%3D_class)%0A%0A%20%20%20%20%23%20Step%203%3A%20Compute%20ROC%20curves%20for%20each%20class%0A%20%20%20%20fpr%2C%20tpr%2C%20roc_auc%20%3D%20%7B%7D%2C%20%7B%7D%2C%20%7B%7D%0A%20%20%20%20for%20i%20in%20range(n_classes)%3A%0A%20%20%20%20%20%20%20%20fpr%5Bi%5D%2C%20tpr%5Bi%5D%2C%20_%20%3D%20roc_curve(y_test_bin%5B%3A%2C%20i%5D%2C%20y_probs%5B%3A%2C%20i%5D)%0A%20%20%20%20%20%20%20%20roc_auc%5Bi%5D%20%3D%20auc(fpr%5Bi%5D%2C%20tpr%5Bi%5D)%0A%0A%20%20%20%20%23%20Step%204%3A%20Compute%20micro-average%0A%20%20%20%20fpr%5B%22micro%22%5D%2C%20tpr%5B%22micro%22%5D%2C%20_%20%3D%20roc_curve(y_test_bin.ravel()%2C%20y_probs.ravel())%0A%20%20%20%20roc_auc%5B%22micro%22%5D%20%3D%20auc(fpr%5B%22micro%22%5D%2C%20tpr%5B%22micro%22%5D)%0A%0A%20%20%20%20%23%20Step%205%3A%20Compute%20macro-average%20(interpolated)%0A%20%20%20%20all_fpr%20%3D%20np.unique(np.concatenate(%5Bfpr%5Bi%5D%20for%20i%20in%20range(n_classes)%5D))%0A%20%20%20%20mean_tpr%20%3D%20np.zeros_like(all_fpr)%0A%20%20%20%20for%20i%20in%20range(n_classes)%3A%0A%20%20%20%20%20%20%20%20mean_tpr%20%2B%3D%20np.interp(all_fpr%2C%20fpr%5Bi%5D%2C%20tpr%5Bi%5D)%0A%20%20%20%20mean_tpr%20%2F%3D%20n_classes%0A%20%20%20%20fpr%5B%22macro%22%5D%20%3D%20all_fpr%0A%20%20%20%20tpr%5B%22macro%22%5D%20%3D%20mean_tpr%0A%20%20%20%20roc_auc%5B%22macro%22%5D%20%3D%20auc(fpr%5B%22macro%22%5D%2C%20tpr%5B%22macro%22%5D)%0A%0A%20%20%20%20%23%20Step%206%3A%20Plot%0A%20%20%20%20plt.figure(figsize%3D(8%2C%206))%0A%20%20%20%20colors%20%3D%20%5B'blue'%2C%20'red'%2C%20'green'%2C%20'orange'%5D%0A%0A%20%20%20%20%23%20Plot%20individual%20classes%0A%20%20%20%20for%20i%2C%20color%20in%20zip(range(n_classes)%2C%20colors)%3A%0A%20%20%20%20%20%20%20%20plt.plot(fpr%5Bi%5D%2C%20tpr%5Bi%5D%2C%20color%3Dcolor%2C%20lw%3D2%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Class%20%7Bi%7D%20(AUC%20%3D%20%7Broc_auc%5Bi%5D%3A.2f%7D)')%0A%0A%20%20%20%20%23%20Plot%20micro%20and%20macro%20averages%0A%20%20%20%20plt.plot(fpr%5B%22micro%22%5D%2C%20tpr%5B%22micro%22%5D%2C%20color%3D'deeppink'%2C%20linestyle%3D'%3A'%2C%20lw%3D4%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Micro-average%20(AUC%20%3D%20%7Broc_auc%5B%22micro%22%5D%3A.2f%7D)')%0A%20%20%20%20plt.plot(fpr%5B%22macro%22%5D%2C%20tpr%5B%22macro%22%5D%2C%20color%3D'navy'%2C%20linestyle%3D'%3A'%2C%20lw%3D4%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20label%3Df'Macro-average%20(AUC%20%3D%20%7Broc_auc%5B%22macro%22%5D%3A.2f%7D)')%0A%0A%20%20%20%20plt.plot(%5B0%2C%201%5D%2C%20%5B0%2C%201%5D%2C%20'k--'%2C%20lw%3D2)%0A%20%20%20%20plt.xlabel('False%20Positive%20Rate')%0A%20%20%20%20plt.ylabel('True%20Positive%20Rate')%0A%20%20%20%20plt.title('Multiclass%20ROC%20Curve')%0A%20%20%20%20plt.legend(loc%3D%22lower%20right%22)%0A%0A%0A%20%20%20%20plt.gca()%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20all_fpr%2C%0A%20%20%20%20%20%20%20%20color%2C%0A%20%20%20%20%20%20%20%20colors%2C%0A%20%20%20%20%20%20%20%20fpr%2C%0A%20%20%20%20%20%20%20%20i%2C%0A%20%20%20%20%20%20%20%20mean_tpr%2C%0A%20%20%20%20%20%20%20%20n_classes%2C%0A%20%20%20%20%20%20%20%20roc_auc%2C%0A%20%20%20%20%20%20%20%20tpr%2C%0A%20%20%20%20%20%20%20%20y_probs%2C%0A%20%20%20%20%20%20%20%20y_test_bin%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
